<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Parallelizing Neural Network Training by AdamXiaotCao</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Parallelizing Neural Network Training</h1>
      <h2 class="project-tagline">Xiaotian Cao (xcao1)</h2>
      <a href="https://github.com/AdamXiaotCao/418-project-website" class="btn">View on GitHub</a>
      <a href="https://github.com/AdamXiaotCao/418-project-website/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/AdamXiaotCao/418-project-website/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="final-report" class="anchor" href="#final-report" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Final Report</h1>

<h3>
<a id="summary" class="anchor" href="#summary" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Summary</h3>

<p>Since the project checkpoint, my project goal has diverted a little bit. For the final project, I implemented a framework for Neural Network training. It uses openmp to exploit the parallelism. Neural Network training process has the potential for parallelism when we update weights and calculate values for neurons. More specifically, neurons at the same level can be considered as independent to each other. Therefore, I used this observation to help me parallelize the training process of Neural Network. Overall, my implementation achieves a 35% speedup when training a network with 200 hidden neurons. It runs on GHC machine.</p>

<h3>
<a id="background" class="anchor" href="#background" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Background:</h3>

<p>Neural Network uses Feed Forward algorithm to compute the value for each neuron. And it uses Back Propagation to update the weights between neurons. Feed Forward essentially computes the value of neuron by multiplying previous neurons and weights and then apply a transfer function. The weights are usually randomized at the beginning of the training. One can think of this process as multiple matrix multiplications between neurons and weights. At the end of feed forward algorithm, it will check the output against the actual data. And base on this result, it will update the weights accordingly, this way it improves accuracy of this neural network. The process of updating the weights is called Back propagation.</p>

<h3>
<a id="approach" class="anchor" href="#approach" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Approach:</h3>

<p>Overall, the framework contains a neuralNetworkTrainer class that captures the essence of neural network. User can configure this class by constructing an object of it. User can then pass parameters such as number of iterations, momentum, and so on. Once user have constructed such object, he or she can then call the train() method to initiate the training process. Inside the neuralNetworkTrainer class, I used 2-d array to represent neural network. This representation allowed me to use openmp easily. The train method invokes feed forward and back propagate to continuously update the neural network until the network is able to predict results with high enough accuracy. Inside the feed forward and back propagate method, I used openmp with static scheduling and fixed pool size. The pool size was tuned for GHC machines. </p>

<h3>
<a id="results" class="anchor" href="#results" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Results:</h3>

<p>Compared to the sequential version of the same program, my framework achieved roughly 35% speedup while having 200 hidden neurons. As the test result shows, as hidden units increase, my program obtains a better speedup. This is because my framework mainly focuses on parallelizing computing neurons locate at the same level. Nonetheless, this result applies to GHC machines only.  </p>

<p><a href="https://www.dropbox.com/s/83y4y698n7koe9e/Screen%20Shot%202016-05-09%20at%202.06.21%20AM.png?dl=0">Result Graph</a></p>

<h3>
<a id="references" class="anchor" href="#references" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>References:</h3>

<p>Paper:</p>

<ol>
<li><p>Abhishek, K., A. Khairwa, T. Pratap, and S. Prakash. "A Stock Market Prediction Model Using Artificial Neural Network." 2012 Third International Conference on Computing, Communication and Networking Technologies (ICCCNT'12) (2012): n. pag. Web.</p></li>
<li><p>Dahl, George, Alan McAvinney, and Tia Newhall. "Parallelizing neural network training for cluster systems." Proceedings of the IASTED International Conference on Parallel and Distributed Computing and Networks. ACTA Press, 2008.</p></li>
</ol>

<p>Neural Network Implementation:
<a href="https://takinginitiative.wordpress.com/2008/04/23/basic-neural-network-tutorial-c-implementation-and-source-code/">https://takinginitiative.wordpress.com/2008/04/23/basic-neural-network-tutorial-c-implementation-and-source-code/</a></p>

<h1>
<a id="project-checkpoint" class="anchor" href="#project-checkpoint" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Project Checkpoint</h1>

<h3>
<a id="checkpoint-report" class="anchor" href="#checkpoint-report" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Checkpoint Report</h3>

<p>As of Apr 19th, I have implemented a neural network that is able to take in data and make predictions. Currently it does not have anything parallel at the moment. And it is not able to constantly pulling new data and make predictions. Overall, I think I am still on schedule or maybe just a little bit behind. Nonetheless, after more researching and discuss with people, I decided to scale down my project goal a little bit. Currently, I want to focus on single-node training using OpenMP and maybe SIMD. I decided to put the idea of multi-node training on hold because it seems to involve a lot of extra work. I am not sure If I will be able to implement a multi-node training framework on time.</p>

<p>On the day of presentation, I intend to have graphs that display the speedup obtain by parallelized training. In addition, I want to present graphs that shows the predicted stock price vs actual stock price. If possible, I hope demo a real time prediction vs actual chart.</p>

<p>Lastly, here is a more detailed schedule for the rest of the project:</p>

<ul>
<li>
<strong>April 22</strong>: Use open mp to parallelize the training part and able to run on latedays.</li>
<li>
<strong>April 27</strong>: Implement a program that constantly collects real time stock data and feed to the neural network.</li>
<li>
<strong>May 4</strong>: A program that constantly pulls real-time data and emit stock prediction.</li>
<li>
<strong>May 6</strong>: Final writeup</li>
</ul>

<h1>
<a id="project-proposal" class="anchor" href="#project-proposal" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Project Proposal</h1>

<h3>
<a id="summary-1" class="anchor" href="#summary-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Summary</h3>

<p>I am going to implement an application that predicts stock price. It would involve using neural network and I will parallelize the training process using multi-core cpu platforms/clusters. </p>

<h3>
<a id="background-1" class="anchor" href="#background-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Background</h3>

<p>The training process for neural network has good potential for speedup. A neural network is usually composed of number of neurons separated into multiple levels. Matrix multiplication is usually involved in calculating weights for each neuron. In addition, when using backward propagation algorithm, at each layer, neurons are usually independent from each other. Therefore, we could compute weights for these independent neurons in parallel. Therefore, with large amount of data, we should see a significant speedup after we parallelized the training process.  </p>

<h3>
<a id="the-challenge" class="anchor" href="#the-challenge" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Challenge</h3>

<p>There are a few challenges when trying to parallelize the training process. </p>

<ul>
<li>When using backward propagation, we need to make sure each cpu completes jobs layer by layer. </li>
<li>Since we can get real time quotes for stock price, if we want to exploit this fact, we need to make sure each node has same up-to-date copy of data.</li>
</ul>

<h3>
<a id="resources" class="anchor" href="#resources" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Resources</h3>

<p>For this project, I will use Lateday clusters to carry out the training process. Yahoo API will help me to obtain real-time stock quotes. In terms of code, I will start the project from scratch. Lastly, there are a few paper that talks about either stock prediction using Neural Networks or parallelizing Neural Networks training.</p>

<ol>
<li><p>Abhishek, K., A. Khairwa, T. Pratap, and S. Prakash. "A Stock Market Prediction Model Using Artificial Neural Network." 2012 Third International Conference on Computing, Communication and Networking Technologies (ICCCNT'12) (2012): n. pag. Web.</p></li>
<li><p>Dahl, George, Alan McAvinney, and Tia Newhall. "Parallelizing neural network training for cluster systems." Proceedings of the IASTED International Conference on Parallel and Distributed Computing and Networks. ACTA Press, 2008.</p></li>
</ol>

<h3>
<a id="goals-and-deliverables" class="anchor" href="#goals-and-deliverables" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Goals and Deliverables</h3>

<ul>
<li>
<strong>Plan to achieve:</strong> 
⋅⋅1. A program that emits stock price prediction about every second. It also displays actual stock price on the side.
⋅⋅2. speed up that is close to linear in terms of number of nodes in the training process. I believe this can be done since the workload for calculating the weights for each neuron should be similar. 
⋅⋅3. fairly accurate prediction of stock price for the next minute.
⋅⋅4. a graph that shows prediction vs actual data</li>
<li>
<strong>Hope to achieve:</strong> 
⋅⋅1. High accuracy prediction.
⋅⋅2. Linear speed up or more than linear speed up.</li>
</ul>

<h3>
<a id="platform-choice" class="anchor" href="#platform-choice" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Platform Choice</h3>

<p>I will use Latedays machine to help me speed up the training process. And I will use C++ as the language because I am planning to experiment SIMD and OpenMP. Latedays are powerful cluster that allows me to split tasks across nodes. SIMD and OpenMp would be helpful when performing matrix multiplcation. </p>

<h3>
<a id="schedule" class="anchor" href="#schedule" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Schedule</h3>

<ul>
<li>
<strong>April 15</strong>: A working Neural Network implementation that is able to emit stock prediction.</li>
<li>
<strong>April 22</strong>: Parallelize matrix multiplication part.</li>
<li>
<strong>April 29</strong>: Parallelize training process in terms of layers.</li>
<li>
<strong>May 6</strong>: A program that constantly pulls real-time data and emit stock prediction.</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/AdamXiaotCao/418-project-website">Parallelizing Neural Network Training</a> is maintained by <a href="https://github.com/AdamXiaotCao">AdamXiaotCao</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
